---
import Layout from '../layouts/Layout.astro';
import Footer from '../components/Footer.astro';
---

<Layout title="Elo Documentation" activeNav="doc">
  <main class="doc-panel" data-controller="doc">
    <aside class="doc-toc">
      <nav>
        <span class="toc-section">Core</span>
        <a href="#types">Types</a>
        <a href="#literals">Literals</a>
        <a href="#type-selectors">Type Selectors</a>
        <a href="#operators">Operators</a>
        <a href="#tuples">Tuples</a>
        <a href="#lists">Lists</a>
        <a href="#lambdas">Lambdas</a>
        <span class="toc-section">Expressions</span>
        <a href="#variables">Variables</a>
        <a href="#conditionals">Conditionals</a>
        <a href="#ranges">Range Membership</a>
        <span class="toc-section">Data</span>
        <a href="#data-selector">Data Selector</a>
        <a href="#input">Input Data</a>
        <a href="#data-paths">Data Paths</a>
        <a href="#data-schemas">Data Schemas</a>
        <a href="#data-formats">Data Formats</a>
        <span class="toc-section">Runtime</span>
        <a href="#assertions">Assertions</a>
        <span class="toc-section">Get Started</span>
        <a href="#get-started">Installation</a>
        <a href="#javascript-api">JavaScript API</a>
        <a href="#command-line">Command Line</a>
      </nav>
    </aside>
    <article class="doc-content">
      <header class="page-header">
        <h1>The Elo Language</h1>
        <p class="page-intro">
          Elo is a small expression language that compiles to <strong>JavaScript</strong>,
          <strong>Ruby</strong>, and <strong>SQL</strong>. Write once, run anywhere.
        </p>
      </header>

      <section class="doc-section" id="types">
        <h2>Types</h2>
        <p>Elo has a simple type system with the following types. Use <code>typeOf()</code> to inspect types at runtime.</p>
        <table class="type-table">
          <thead>
            <tr><th>Type</th><th>Description</th><th>Examples</th></tr>
          </thead>
          <tbody>
            <tr><td><code>Int</code></td><td>Integer numbers</td><td><code>42</code>, <code>-7</code>, <code>0</code></td></tr>
            <tr><td><code>Float</code></td><td>Floating-point numbers</td><td><code>3.14</code>, <code>-0.5</code></td></tr>
            <tr><td><code>Bool</code></td><td>Boolean values</td><td><code>true</code>, <code>false</code></td></tr>
            <tr><td><code>String</code></td><td>Text strings</td><td><code>'hello'</code>, <code>'world'</code></td></tr>
            <tr><td><code>DateTime</code></td><td>Dates and timestamps</td><td><code>D2024-01-15</code>, <code>NOW</code>, <code>TODAY</code></td></tr>
            <tr><td><code>Duration</code></td><td>Time periods</td><td><code>P1D</code>, <code>PT2H30M</code>, <code>P1Y2M</code></td></tr>
            <tr><td><code>Tuple</code></td><td>Key-value tuples</td><td><code>&#123;name: 'Alice', age: 30&#125;</code></td></tr>
            <tr><td><code>List</code></td><td>Ordered collections</td><td><code>[1, 2, 3]</code>, <code>['a', 'b']</code></td></tr>
            <tr><td><code>Function</code></td><td>Lambda functions</td><td><code>fn( x ~> x * 2 )</code></td></tr>
            <tr><td><code>Null</code></td><td>Null values</td><td><code>null</code></td></tr>
          </tbody>
        </table>
        <p class="note"><strong>Note:</strong> Use <code>null</code> for absent values. Use <code>isNull()</code> to check for null, and the <code>|</code> operator to provide defaults: <code>x | 'default'</code>.</p>
        <div class="example" data-action="click->doc#tryExample">
          <div class="example-header">Type Introspection</div>
          <pre class="example-code">typeOf(42) == 'Int' and typeOf(P1D) == 'Duration'</pre>
          <p class="example-desc">Use <code>typeOf()</code> to get the type name as a string.</p>
        </div>
      </section>

      <section class="doc-section" id="literals">
        <h2>Literals</h2>
        <p>Elo supports numbers, booleans, strings, dates, and durations as first-class values.</p>
        <h3>Numbers</h3>
        <div class="example" data-action="click->doc#tryExample">
          <div class="example-header">Integers &amp; Floats</div>
          <pre class="example-code">42 + 3.14</pre>
          <p class="example-desc">Numbers include integers and floating-point values.</p>
        </div>
        <h3>Booleans</h3>
        <div class="example" data-action="click->doc#tryExample">
          <div class="example-header">Boolean Literals</div>
          <pre class="example-code">true and not false</pre>
          <p class="example-desc"><code>true</code> and <code>false</code> are boolean literals.</p>
        </div>
        <h3>Strings</h3>
        <div class="example" data-action="click->doc#tryExample">
          <div class="example-header">String Literal</div>
          <pre class="example-code">'hello world'</pre>
          <p class="example-desc">Strings use single quotes. Escape with backslash: <code>'it\'s working'</code>.</p>
        </div>
        <h3>Dates &amp; Times</h3>
        <div class="example" data-action="click->doc#tryExample">
          <div class="example-header">Date Literal</div>
          <pre class="example-code">D2025-12-25</pre>
          <p class="example-desc">ISO date format with <code>D</code> prefix.</p>
        </div>
        <div class="example" data-action="click->doc#tryExample">
          <div class="example-header">Temporal Keywords</div>
          <pre class="example-code">TODAY &lt; NOW</pre>
          <p class="example-desc"><code>NOW</code> is the current timestamp, <code>TODAY</code> is midnight today.</p>
        </div>
        <div class="example" data-action="click->doc#tryExample">
          <div class="example-header">Period Boundaries</div>
          <pre class="example-code">SOY &lt;= TODAY and TODAY &lt;= EOY</pre>
          <p class="example-desc">Start/End of Year (<code>SOY</code>/<code>EOY</code>), Quarter (<code>SOQ</code>/<code>EOQ</code>), Month (<code>SOM</code>/<code>EOM</code>), Week (<code>SOW</code>/<code>EOW</code>).</p>
        </div>
        <div class="example" data-action="click->doc#tryExample">
          <div class="example-header">Time Boundaries</div>
          <pre class="example-code">TODAY in BOT ... EOT</pre>
          <p class="example-desc">Beginning of Time (<code>BOT</code>) and End of Time (<code>EOT</code>) for open-ended ranges.</p>
        </div>
        <h3>Durations</h3>
        <div class="example" data-action="click->doc#tryExample">
          <div class="example-header">Duration Literal</div>
          <pre class="example-code">P1Y2M3D</pre>
          <p class="example-desc">1 year, 2 months, 3 days. Use <code>P</code> prefix (ISO 8601).</p>
        </div>
        <div class="example" data-action="click->doc#tryExample">
          <div class="example-header">Time Durations</div>
          <pre class="example-code">PT2H30M</pre>
          <p class="example-desc">2 hours and 30 minutes. Use <code>PT</code> for time-only durations.</p>
        </div>
        <h3>Data Paths</h3>
        <div class="example" data-action="click->doc#tryExample">
          <div class="example-header">Path Literal</div>
          <pre class="example-code">.user.address.city</pre>
          <p class="example-desc">Shorthand for <code>['user', 'address', 'city']</code>. See <a href="#data-paths">Data Paths</a>.</p>
        </div>
      </section>

      <section class="doc-section" id="type-selectors">
        <h2>Type Selectors</h2>
        <p>Literal syntax (like <code>42</code> or <code>'hello'</code>) is shorthand for type selectors. Type selectors validate and convert values to specific types. They throw an error if parsing fails.</p>
        <div class="example" data-action="click->doc#tryExample">
          <div class="example-header">Parse String to Integer</div>
          <pre class="example-code">Int('123')</pre>
          <p class="example-desc">Parses the string to the integer <code>123</code>.</p>
        </div>
        <div class="example" data-action="click->doc#tryExample">
          <div class="example-header">Convert to String</div>
          <pre class="example-code">String(42) + ' items'</pre>
          <p class="example-desc">Converts a value to its string representation.</p>
        </div>
        <div class="example" data-action="click->doc#tryExample">
          <div class="example-header">Parse Date</div>
          <pre class="example-code">Date('2024-12-25')</pre>
          <p class="example-desc">Parses ISO 8601 date string to a date value.</p>
        </div>
        <div class="example" data-action="click->doc#tryExample">
          <div class="example-header">Parse JSON</div>
          <pre class="example-code">Data('&#123;"name": "Alice"&#125;').name</pre>
          <p class="example-desc">Parses a JSON string and accesses a property.</p>
        </div>
        <p>Available: <code>Int()</code>, <code>Float()</code>, <code>Bool()</code>, <code>String()</code>, <code>Null()</code>, <code>Date()</code>, <code>Datetime()</code>, <code>Duration()</code>, <code>Data()</code>.</p>
        <p class="note"><strong>Note:</strong> Type selectors can be combined into <a href="#data-schemas">Data Schemas</a> for validating complex data structures.</p>
      </section>

      <section class="doc-section" id="operators">
        <h2>Operators</h2>
        <p>Elo provides arithmetic, comparison, and logical operators.</p>
        <h3>Arithmetic</h3>
        <div class="example" data-action="click->doc#tryExample">
          <div class="example-header">Basic Operations</div>
          <pre class="example-code">(10 + 5) * 2 - 8 / 4</pre>
          <p class="example-desc">Addition <code>+</code>, subtraction <code>-</code>, multiplication <code>*</code>, division <code>/</code>.</p>
        </div>
        <div class="example" data-action="click->doc#tryExample">
          <div class="example-header">Power &amp; Modulo</div>
          <pre class="example-code">2 ^ 10 + 17 % 5</pre>
          <p class="example-desc">Power <code>^</code> and remainder <code>%</code> operators.</p>
        </div>
        <div class="example" data-action="click->doc#tryExample">
          <div class="example-header">Date Arithmetic</div>
          <pre class="example-code">TODAY + P7D</pre>
          <p class="example-desc">Add durations to dates. Subtract with <code>-</code>.</p>
        </div>
        <h3>Comparison</h3>
        <div class="example" data-action="click->doc#tryExample">
          <div class="example-header">Comparison Operators</div>
          <pre class="example-code">10 > 5 and 3 &lt;= 3</pre>
          <p class="example-desc">Use <code>&gt;</code>, <code>&lt;</code>, <code>&gt;=</code>, <code>&lt;=</code>, <code>==</code>, <code>!=</code>.</p>
        </div>
        <h3>Logical</h3>
        <div class="example" data-action="click->doc#tryExample">
          <div class="example-header">Logical Operators</div>
          <pre class="example-code">(5 > 3 and 2 &lt; 4) or not (1 == 2)</pre>
          <p class="example-desc">Combine conditions with <code>and</code>, <code>or</code>, and <code>not</code>.</p>
        </div>
        <h3>Pipe Operator</h3>
        <div class="example" data-action="click->doc#tryExample">
          <div class="example-header">Function Chaining</div>
          <pre class="example-code">'  hello world  ' |> trim |> upper</pre>
          <p class="example-desc">The pipe operator <code>|&gt;</code> passes the left value as the first argument to the right function.</p>
        </div>
        <div class="example" data-action="click->doc#tryExample">
          <div class="example-header">Pipe with Arguments</div>
          <pre class="example-code">'42' |> padStart(5, '0')</pre>
          <p class="example-desc">Additional arguments follow the piped value.</p>
        </div>
        <h3>Alternative Operator</h3>
        <div class="example" data-action="click->doc#tryExample">
          <div class="example-header">Fallback Chain</div>
          <pre class="example-code">indexOf('hello', 'x') | indexOf('hello', 'l') | -1</pre>
          <p class="example-desc">The <code>|</code> operator returns the first non-null value.</p>
        </div>
      </section>

      <section class="doc-section" id="tuples">
        <h2>Tuples</h2>
        <p>Elo tuples are collections of named values. They use JSON-like syntax with key-value pairs and compile to native structures in each target language.</p>
        <div class="example" data-action="click->doc#tryExample">
          <div class="example-header">Simple Tuple</div>
          <pre class="example-code">&#123;name: 'Alice', age: 30&#125;</pre>
          <p class="example-desc">Create a tuple with named attributes.</p>
        </div>
        <div class="example" data-action="click->doc#tryExample">
          <div class="example-header">Attribute Access</div>
          <pre class="example-code">&#123;budget: 1500&#125;.budget</pre>
          <p class="example-desc">Access attributes with dot notation.</p>
        </div>
        <div class="example" data-action="click->doc#tryExample">
          <div class="example-header">Tuple with Let</div>
          <pre class="example-code">let t = &#123;x: 10, y: 20&#125; in t.x + t.y</pre>
          <p class="example-desc">Bind a tuple to a variable and access its attributes.</p>
        </div>
        <p class="note"><strong>Note:</strong> Tuples look like JavaScript objects but Elo uses relational terminology. In SQL, they compile to PostgreSQL JSONB using <code>jsonb_build_object()</code>.</p>
      </section>

      <section class="doc-section" id="lists">
        <h2>Lists</h2>
        <p>Elo lists are ordered sequences using JSON-like array syntax. Lists are heterogeneous and compile to native arrays.</p>
        <div class="example" data-action="click->doc#tryExample">
          <div class="example-header">Simple List</div>
          <pre class="example-code">[1, 2, 3]</pre>
          <p class="example-desc">Create a list with integer elements.</p>
        </div>
        <div class="example" data-action="click->doc#tryExample">
          <div class="example-header">Mixed Types</div>
          <pre class="example-code">[1, 'two', true, null]</pre>
          <p class="example-desc">Lists can mix different types including null.</p>
        </div>
        <div class="example" data-action="click->doc#tryExample">
          <div class="example-header">Nested Lists</div>
          <pre class="example-code">[[1, 2], [3, 4]]</pre>
          <p class="example-desc">Lists can contain other lists.</p>
        </div>
        <p class="note"><strong>Note:</strong> Lists look like JavaScript arrays but Elo uses relational terminology. In SQL, they compile to PostgreSQL <code>ARRAY[...]</code> syntax.</p>
      </section>

      <section class="doc-section" id="lambdas">
        <h2>Lambdas</h2>
        <p>Elo provides anonymous functions using lambdas:</p>
        <ul>
          <li><strong>Lambdas</strong>: <code>fn( params ~> body )</code> or <code>x ~> body</code> (sugar)</li>
        </ul>
        <h3>Lambda Expressions</h3>
        <div class="example" data-action="click->doc#tryExample">
          <div class="example-header">Simple Lambda</div>
          <pre class="example-code">fn( x ~> x * 2 )</pre>
          <p class="example-desc">A function that doubles its input.</p>
        </div>
        <div class="example" data-action="click->doc#tryExample">
          <div class="example-header">Multiple Parameters</div>
          <pre class="example-code">fn( x, y ~> x + y )</pre>
          <p class="example-desc">Lambdas can take multiple parameters.</p>
        </div>
        <div class="example" data-action="click->doc#tryExample">
          <div class="example-header">Sugar Syntax</div>
          <pre class="example-code">[1, 2, 3] |> map(x ~> x * 2)</pre>
          <p class="example-desc">Single-param lambdas can omit <code>fn()</code>. Returns [2, 4, 6].</p>
        </div>
        <h3>Invoking Lambdas</h3>
        <div class="example" data-action="click->doc#tryExample">
          <div class="example-header">Call a Lambda</div>
          <pre class="example-code">let double = fn( x ~> x * 2 ) in double(5)</pre>
          <p class="example-desc">Bind a lambda to a name, then call it. Returns 10.</p>
        </div>
        <p class="note"><strong>Note:</strong> Lambdas compile to JavaScript and Ruby only. SQL does not support function expressions.</p>
      </section>

      <section class="doc-section" id="variables">
        <h2>Local Variables</h2>
        <p>Use <code>let ... in</code> expressions to bind local variables.</p>
        <div class="example" data-action="click->doc#tryExample">
          <div class="example-header">Simple Binding</div>
          <pre class="example-code">let x = 10 in x * 2</pre>
          <p class="example-desc">Bind a value to a name, then use it in an expression.</p>
        </div>
        <div class="example" data-action="click->doc#tryExample">
          <div class="example-header">Multiple Bindings</div>
          <pre class="example-code">let width = 5, height = 3 in width * height</pre>
          <p class="example-desc">Bind multiple variables separated by commas.</p>
        </div>
      </section>

      <section class="doc-section" id="conditionals">
        <h2>Conditionals</h2>
        <p>Use <code>if ... then ... else</code> expressions to branch based on conditions.</p>
        <div class="example" data-action="click->doc#tryExample">
          <div class="example-header">Simple Conditional</div>
          <pre class="example-code">if 5 > 3 then 'yes' else 'no'</pre>
          <p class="example-desc">Returns 'yes' if the condition is true, 'no' otherwise.</p>
        </div>
        <div class="example" data-action="click->doc#tryExample">
          <div class="example-header">Conditional with Let</div>
          <pre class="example-code">let x = 10 in if x > 5 then 'big' else 'small'</pre>
          <p class="example-desc">Combine conditionals with local variables.</p>
        </div>
      </section>

      <section class="doc-section" id="ranges">
        <h2>Range Membership</h2>
        <p>Check if a value falls within a range using the <code>in</code> operator.</p>
        <div class="example" data-action="click->doc#tryExample">
          <div class="example-header">Inclusive Range</div>
          <pre class="example-code">5 in 1..10</pre>
          <p class="example-desc">True if 5 &gt;= 1 AND 5 &lt;= 10. Both ends are included.</p>
        </div>
        <div class="example" data-action="click->doc#tryExample">
          <div class="example-header">Exclusive End Range</div>
          <pre class="example-code">5 in 1...10</pre>
          <p class="example-desc">True if 5 &gt;= 1 AND 5 &lt; 10. End is excluded.</p>
        </div>
        <div class="example" data-action="click->doc#tryExample">
          <div class="example-header">Date Range Check</div>
          <pre class="example-code">TODAY in SOY..EOY</pre>
          <p class="example-desc">Check if today is within the current year.</p>
        </div>
      </section>

      <section class="doc-section" id="data-selector">
        <h2>Data Selector</h2>
        <p>The <code>Data()</code> selector parses JSON strings into Elo values. This is useful when receiving data as text from external sources.</p>
        <div class="example" data-action="click->doc#tryExample">
          <div class="example-header">Parse JSON Object</div>
          <pre class="example-code">Data('&#123;"name": "Alice", "age": 30&#125;')</pre>
          <p class="example-desc">Parses a JSON string into a tuple with <code>name</code> and <code>age</code> attributes.</p>
        </div>
        <div class="example" data-action="click->doc#tryExample">
          <div class="example-header">Parse JSON Array</div>
          <pre class="example-code">Data('[1, 2, 3]')</pre>
          <p class="example-desc">Parses a JSON string into a list.</p>
        </div>
        <div class="example" data-action="click->doc#tryExample">
          <div class="example-header">Access Parsed Data</div>
          <pre class="example-code">Data('&#123;"user": &#123;"name": "Bob"&#125;&#125;').user.name</pre>
          <p class="example-desc">Parse and immediately access nested properties.</p>
        </div>
        <p class="note"><strong>Note:</strong> See <a href="#type-selectors">Type Selectors</a> for all available selectors. For validating and transforming complex JSON structures, see <a href="#data-schemas">Data Schemas</a>.</p>
      </section>

      <section class="doc-section" id="input">
        <h2>Input Data</h2>
        <p>Every Elo program has access to external input via the special <code>_</code> variable.
           When an expression uses <code>_</code>, the compiled output becomes a function that takes input data as a parameter.</p>
        <div class="example" data-action="click->doc#tryExample" data-input="21">
          <div class="example-header">Simple Input</div>
          <pre class="example-code">_ * 2</pre>
          <p class="example-desc">Doubles the input value.</p>
        </div>
        <div class="example" data-action="click->doc#tryExample" data-input='{"price": 100, "quantity": 3}'>
          <div class="example-header">Tuple Input</div>
          <pre class="example-code">_.price * _.quantity</pre>
          <p class="example-desc">Access attributes of an input tuple.</p>
        </div>
        <div class="example" data-action="click->doc#tryExample" data-input='{"budget": 100}'>
          <div class="example-header">Input with Transformation</div>
          <pre class="example-code">_.budget * 1.21</pre>
          <p class="example-desc">Apply VAT to a budget value from input.</p>
        </div>
        <p class="note"><strong>Note:</strong> When using the CLI, use <code>elo</code> with JSON input: <code>elo -e "_.x + _.y" -d '&#123;"x": 1, "y": 2&#125;'</code></p>
      </section>

      <section class="doc-section" id="data-paths">
        <h2>Data Paths</h2>
        <p>Data paths are <strong>syntactic sugar</strong> for lists of strings and integers. They provide a concise way to describe locations within nested data structures.</p>
        <div class="example" data-action="click->doc#tryExample">
          <div class="example-header">Simple Path</div>
          <pre class="example-code">.name</pre>
          <p class="example-desc">Equivalent to <code>['name']</code>.</p>
        </div>
        <div class="example" data-action="click->doc#tryExample">
          <div class="example-header">Nested Path</div>
          <pre class="example-code">.user.address.city</pre>
          <p class="example-desc">Equivalent to <code>['user', 'address', 'city']</code>.</p>
        </div>
        <div class="example" data-action="click->doc#tryExample">
          <div class="example-header">Path with Index</div>
          <pre class="example-code">.items.0.name</pre>
          <p class="example-desc">Equivalent to <code>['items', 0, 'name']</code>. Integers access list elements.</p>
        </div>
        <h3>Navigating Data</h3>
        <p>Use <code>fetch()</code> to retrieve values and <code>patch()</code> to update them immutably.</p>
        <div class="example" data-action="click->doc#tryExample">
          <div class="example-header">Fetch Value</div>
          <pre class="example-code">fetch(&#123;user: &#123;name: 'Alice'&#125;&#125;, .user.name)</pre>
          <p class="example-desc">Returns <code>'Alice'</code>. Returns <code>null</code> if path doesn't exist.</p>
        </div>
        <div class="example" data-action="click->doc#tryExample">
          <div class="example-header">Patch Value</div>
          <pre class="example-code">patch(&#123;user: &#123;name: 'Alice'&#125;&#125;, .user.name, 'Bob')</pre>
          <p class="example-desc">Returns a new tuple with the value updated at the path.</p>
        </div>
        <p class="note"><strong>Note:</strong> Since data paths are lists, <code>typeOf(.name)</code> returns <code>'List'</code>. The stdlib uses "DataPath" as a conceptual name in function signatures.</p>
      </section>

      <section class="doc-section" id="data-schemas">
        <h2>Data Schemas</h2>
        <p>Data schemas let you validate and transform complex data structures like JSON. Define schemas using uppercase <code>let</code> bindings with <a href="#type-selectors">type selectors</a>, then apply them with the pipe operator.</p>
        <p class="note"><strong>Note:</strong> Data schemas compile to JavaScript and Ruby only. SQL is not supported.</p>

        <h3>Basic Types</h3>
        <p>All <a href="#type-selectors">type selectors</a> can be used as schema types: <code>Int</code>, <code>Float</code>, <code>Bool</code>, <code>String</code>, <code>Null</code>, <code>Date</code>, <code>Datetime</code>, <code>Duration</code>, <code>Data</code>. Use <code>.</code> (dot) for any value.</p>
        <div class="example" data-action="click->doc#tryExample">
          <div class="example-header">Type Coercion</div>
          <pre class="example-code">let T = Int in '42' |> T</pre>
          <p class="example-desc">Coerces the string <code>'42'</code> to integer <code>42</code>.</p>
        </div>
        <div class="example" data-action="click->doc#tryExample">
          <div class="example-header">Any Type</div>
          <pre class="example-code">let T = . in 'anything' |> T</pre>
          <p class="example-desc">The dot <code>.</code> accepts any value unchanged.</p>
        </div>

        <h3>Tuple Types</h3>
        <div class="example" data-action="click->doc#tryExample">
          <div class="example-header">Simple Tuple</div>
          <pre class="example-code">let Person = &#123; name: String, age: Int &#125; in
&#123; name: 'Alice', age: '30' &#125; |> Person</pre>
          <p class="example-desc">Validates shape and coerces <code>age</code> from string to integer.</p>
        </div>
        <div class="example" data-action="click->doc#tryExample">
          <div class="example-header">Optional Attributes</div>
          <pre class="example-code">let T = &#123; name: String, age :? Int &#125; in
&#123; name: 'Bob' &#125; |> T</pre>
          <p class="example-desc">Optional attributes (with <code>:?</code>) can be missing. Missing fields are omitted from result.</p>
        </div>
        <div class="example" data-action="click->doc#tryExample">
          <div class="example-header">Open Tuple</div>
          <pre class="example-code">let T = &#123; name: String, ... &#125; in
&#123; name: 'Eve', extra: 42 &#125; |> T</pre>
          <p class="example-desc">Open tuples (<code>...</code>) allow extra attributes. They're ignored in output.</p>
        </div>

        <h3>Array Types</h3>
        <div class="example" data-action="click->doc#tryExample">
          <div class="example-header">Array of Integers</div>
          <pre class="example-code">let Numbers = [Int] in ['1', '2', '3'] |> Numbers</pre>
          <p class="example-desc">Coerces each element. Returns <code>[1, 2, 3]</code>.</p>
        </div>
        <div class="example" data-action="click->doc#tryExample">
          <div class="example-header">Array of Tuples</div>
          <pre class="example-code">let People = [&#123; name: String &#125;] in
[&#123; name: 'A' &#125;, &#123; name: 'B' &#125;] |> People</pre>
          <p class="example-desc">Validates each element against the tuple type.</p>
        </div>

        <h3>Union Types</h3>
        <div class="example" data-action="click->doc#tryExample">
          <div class="example-header">Union Type</div>
          <pre class="example-code">let T = Int|String in 'hello' |> T</pre>
          <p class="example-desc">Tries alternatives left-to-right. Returns first successful match.</p>
        </div>
        <div class="example" data-action="click->doc#tryExample">
          <div class="example-header">Mixed Array</div>
          <pre class="example-code">let T = [Int|String] in ['42', 'hello'] |> T</pre>
          <p class="example-desc">Returns <code>[42, 'hello']</code> - numeric strings become integers.</p>
        </div>

        <h3>Subtype Constraints</h3>
        <div class="example" data-action="click->doc#tryExample">
          <div class="example-header">Positive Integer</div>
          <pre class="example-code">let Positive = Int(i | i > 0) in '42' |> Positive</pre>
          <p class="example-desc">Adds a predicate constraint. Throws if value is not positive.</p>
        </div>
        <div class="example" data-action="click->doc#tryExample">
          <div class="example-header">Constrained Tuple</div>
          <pre class="example-code">let Adult = &#123; age: Int(a | a >= 18) &#125; in
&#123; age: '25' &#125; |> Adult</pre>
          <p class="example-desc">Constraints compose with tuple types.</p>
        </div>
        <div class="example" data-action="click->doc#tryExample">
          <div class="example-header">Labeled Constraints</div>
          <pre class="example-code">let PosEven = Int(i | positive: i > 0, even: i % 2 == 0) in
'42' |> PosEven</pre>
          <p class="example-desc">Multiple labeled constraints (Finitio-style). Label becomes error message.</p>
        </div>
        <div class="example" data-action="click->doc#tryExample">
          <div class="example-header">String Messages</div>
          <pre class="example-code">let Adult = Int(a | 'must be 18 or older': a >= 18) in
'25' |> Adult</pre>
          <p class="example-desc">Use string labels for human-readable error messages.</p>
        </div>

        <h3>Named Type Aliases</h3>
        <div class="example" data-action="click->doc#tryExample">
          <div class="example-header">Reusable Types</div>
          <pre class="example-code">let
  Age = Int(a | a >= 0),
  Person = &#123; name: String, age: Age &#125;
in &#123; name: 'Alice', age: '30' &#125; |> Person</pre>
          <p class="example-desc">Define multiple types and reference them by name.</p>
        </div>
      </section>

      <section class="doc-section" id="data-formats">
        <h2>Data Formats</h2>
        <p>The CLI and playground support multiple input and output formats. Input data is parsed and made available as the <code>_</code> variable. Results can be formatted for different use cases.</p>

        <h3>JSON Format</h3>
        <p>JSON is the default format. Values map directly to Elo types:</p>
        <table class="format-table">
          <thead><tr><th>JSON</th><th>Elo Type</th><th>Example</th></tr></thead>
          <tbody>
            <tr><td><code>number</code></td><td>Int or Float</td><td><code>42</code>, <code>3.14</code></td></tr>
            <tr><td><code>string</code></td><td>String</td><td><code>"hello"</code></td></tr>
            <tr><td><code>boolean</code></td><td>Bool</td><td><code>true</code>, <code>false</code></td></tr>
            <tr><td><code>null</code></td><td>Null</td><td><code>null</code></td></tr>
            <tr><td><code>object</code></td><td>Tuple</td><td><code>&#123;"name": "Alice"&#125;</code></td></tr>
            <tr><td><code>array</code></td><td>List</td><td><code>[1, 2, 3]</code></td></tr>
          </tbody>
        </table>
        <div class="example" data-action="click->doc#tryExample" data-input='{"name": "Alice", "age": 30}'>
          <div class="example-header">JSON Input</div>
          <pre class="example-code">upper(_.name) + ' is ' + String(_.age)</pre>
          <p class="example-desc">Access fields from a JSON object.</p>
        </div>

        <h3>CSV Format</h3>
        <p>CSV input is parsed as a <strong>list of tuples</strong>. The first row provides field names (headers), and subsequent rows become tuple values. All values are strings.</p>
        <div class="format-example">
          <div class="format-input">
            <strong>CSV Input:</strong>
            <pre>name,age
Alice,30
Bob,25</pre>
          </div>
          <div class="format-arrow">→</div>
          <div class="format-output">
            <strong>Elo Value (<code>_</code>):</strong>
            <pre>[
  &#123;name: 'Alice', age: '30'&#125;,
  &#123;name: 'Bob', age: '25'&#125;
]</pre>
          </div>
        </div>
        <p>Since CSV values are strings, you can convert them manually:</p>
        <div class="example" data-action="click->doc#tryExample" data-input='[{"name": "Alice", "age": "30"}, {"name": "Bob", "age": "25"}]'>
          <div class="example-header">Manual Conversion</div>
          <pre class="example-code">_ |> map(r ~> &#123;name: r.name, age: Int(r.age)&#125;)</pre>
          <p class="example-desc">Convert age strings to integers field by field.</p>
        </div>
        <p class="note"><strong>Better approach:</strong> Use <a href="#data-schemas">data schemas</a> to declare a schema. This validates structure and converts types in one step:</p>
        <div class="example" data-action="click->doc#tryExample" data-input='[{"name": "Alice", "age": "30"}, {"name": "Bob", "age": "25"}]'>
          <div class="example-header">Schema Conversion</div>
          <pre class="example-code">let Person = &#123;name: String, age: Int&#125;
in _ |> map(p ~> p |> Person)</pre>
          <p class="example-desc">Define a schema once, apply it to each row.</p>
        </div>
        <h3>Output Formats</h3>
        <p>Results can be formatted as:</p>
        <ul>
          <li><strong>JSON</strong> — Standard JSON serialization (default)</li>
          <li><strong>Elo</strong> — Elo code syntax (readable, can be copy-pasted)</li>
          <li><strong>CSV</strong> — For lists of tuples (spreadsheet-compatible)</li>
        </ul>

        <h3>CLI Usage</h3>
        <pre class="cli-example"><code># JSON input (default)
elo -e "_.x + _.y" -d '&#123;"x": 1, "y": 2&#125;'

# CSV input from file (format auto-detected from .csv extension)
elo -e "map(_, r ~> r.name)" -d @data.csv

# Explicit CSV format
elo -e "map(_, r ~> r.name)" -d @data.txt -f csv

# Output as CSV
elo -e "[&#123;a: 1&#125;, &#123;a: 2&#125;]" -o csv

# Output as Elo code
elo -e "&#123;name: 'test'&#125;" -o elo</code></pre>

        <h3>Custom Format Adapters</h3>
        <p>The format system is pluggable. You can provide custom adapters for formats like XLSX using libraries such as PapaParse or SheetJS. See the <code>FormatAdapter</code> interface in <code>src/formats.ts</code>.</p>
      </section>

      <section class="doc-section" id="assertions">
        <h2>Assertions</h2>
        <p>Use <code>assert()</code> to validate conditions at runtime.</p>
        <div class="example" data-action="click->doc#tryExample">
          <div class="example-header">Simple Assert</div>
          <pre class="example-code">assert(2 + 2 == 4)</pre>
          <p class="example-desc">Throws an error if the condition is false.</p>
        </div>
        <div class="example" data-action="click->doc#tryExample">
          <div class="example-header">Fail with Message</div>
          <pre class="example-code">indexOf('hello', 'x') | fail('character not found')</pre>
          <p class="example-desc">Use <code>fail(message)</code> to throw an error with a custom message.</p>
        </div>
      </section>

      <section class="doc-section" id="get-started">
        <h2>Get Started</h2>
        <p>Ready to use Elo on your computer? Here's how to get started.</p>

        <h3>Try Online First</h3>
        <p>The easiest way to explore Elo is the <a href="/try">online playground</a> — no installation needed.</p>

        <h3>Install the CLI</h3>
        <p>To run Elo locally, install the command-line tools via npm:</p>
        <pre class="code-js">npm install -g @enspirit/elo</pre>
        <p>This gives you two commands:</p>
        <ul>
          <li><code>elo</code> — Evaluate Elo expressions and see results immediately</li>
          <li><code>eloc</code> — Compile Elo to JavaScript, Ruby, or SQL</li>
        </ul>

        <h3>Quick Examples</h3>
        <pre class="code-js"># Evaluate an expression
elo -e "2 + 3 * 4"          # => 14

# Evaluate from a file
echo "upper('hello')" > hello.elo
elo hello.elo               # => HELLO

# Compile to JavaScript
eloc -e "2 + 3"             # => (function(_) &#123; return 2 + 3; &#125;)</pre>

        <h3>What's Next?</h3>
        <ul>
          <li><strong>Learning Elo?</strong> Start with the <a href="/learn">Learn</a> tutorial</li>
          <li><strong>Building an app?</strong> See the <a href="#javascript-api">JavaScript API</a> below</li>
          <li><strong>Need a function?</strong> Browse the <a href="/stdlib">Standard Library</a></li>
        </ul>
      </section>

      <section class="doc-section" id="javascript-api">
        <h2>JavaScript API</h2>
        <p>For Node.js or browser projects, install the library:</p>
        <pre class="code-js">npm install @enspirit/elo</pre>
        <h3>compile()</h3>
        <p>Every Elo expression compiles to a function that takes <code>_</code> (the implicit input) as parameter.</p>
        <pre class="code-js">import &#123; compile &#125; from '@enspirit/elo';
import &#123; DateTime, Duration &#125; from 'luxon';

const double = compile('_ * 2', &#123; runtime: &#123; DateTime, Duration &#125; &#125;);
double(21); // => 42</pre>
        <h3>Lower-Level API</h3>
        <pre class="code-js">import &#123; parse, compileToJavaScript, compileToRuby, compileToSQL &#125; from '@enspirit/elo';

const ast = parse('2 + 3 * 4');
compileToJavaScript(ast); // => "2 + 3 * 4"
compileToRuby(ast);       // => "2 + 3 * 4"
compileToSQL(ast);        // => "2 + 3 * 4"</pre>
      </section>

      <section class="doc-section" id="command-line">
        <h2>Command Line</h2>
        <p>Elo provides two CLI tools: <code>eloc</code> (compiler) and <code>elo</code> (evaluator).</p>

        <h3>Evaluator (elo)</h3>
        <p>Quickly evaluate Elo expressions:</p>
        <pre class="code-js"># Evaluate an expression
elo -e "2 + 3 * 4"     # => 14

# Evaluate with input data
elo -e "_.x + _.y" -d '&#123;"x": 1, "y": 2&#125;'   # => 3

# Evaluate from file
elo expressions.elo</pre>
        <table class="type-table">
          <thead><tr><th>Option</th><th>Description</th></tr></thead>
          <tbody>
            <tr><td><code>-e, --expression</code></td><td>Expression to evaluate</td></tr>
            <tr><td><code>-d, --data</code></td><td>JSON input data for <code>_</code></td></tr>
            <tr><td><code>--stdin</code></td><td>Read JSON input from stdin</td></tr>
          </tbody>
        </table>

        <h3>Compiler (eloc)</h3>
        <p>Compile Elo to other languages:</p>
        <pre class="code-js"># Compile to JavaScript (default)
eloc -e "2 + 3 * 4"

# Compile to Ruby
eloc -e "2 + 3 * 4" -t ruby

# Compile to SQL
eloc -e "2 + 3 * 4" -t sql

# Include runtime prelude
eloc -e "NOW + PT2H" -t ruby -p</pre>
        <table class="type-table">
          <thead><tr><th>Option</th><th>Description</th></tr></thead>
          <tbody>
            <tr><td><code>-e, --expression</code></td><td>Expression to compile</td></tr>
            <tr><td><code>-t, --target</code></td><td>Target: <code>js</code>, <code>ruby</code>, <code>sql</code></td></tr>
            <tr><td><code>-p, --prelude</code></td><td>Include runtime imports</td></tr>
            <tr><td><code>-f, --file</code></td><td>Output to file</td></tr>
          </tbody>
        </table>
      </section>

      <Footer className="doc-footer" />
    </article>
  </main>
</Layout>
