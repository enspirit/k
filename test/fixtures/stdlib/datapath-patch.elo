assert(patch({}, .name, 'Alice') == {name: 'Alice'})
assert(patch({name: 'Alice'}, .name, 'Bob') == {name: 'Bob'})
assert(patch({name: 'Alice'}, .age, 30) == {name: 'Alice', age: 30})
assert(patch({}, .user.name, 'Bob') == {user: {name: 'Bob'}})
assert(patch({}, .foo.0.bar, 12) == {foo: [{bar: 12}]})
assert(patch({items: [1, 2, 3]}, .items.1, 99) == {items: [1, 99, 3]})
assert(patch({items: [1]}, .items.3, 99) == {items: [1, null, null, 99]})
assert(patch(null, .x, 1) == {x: 1})
assert(patch({}, .a.b.c, 1) == {a: {b: {c: 1}}})
assertFails(patch([], .foo, 1))
assertFails(patch([1, 2, 3], .foo, 1))
assertFails(patch({foo: []}, .foo.bar, 1))
