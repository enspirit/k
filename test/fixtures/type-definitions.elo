assert((let X = String in 'hello' |> X) == 'hello')
assert((let X = Int in '42' |> X) == 42)
assert((let X = Int in 'bad' |> X) == null)
assert((let X = . in 'anything' |> X) == 'anything')
assert((let X = Any in 123 |> X) == 123)
assert((let Person = { name: String } in { name: 'Alice' } |> Person) == { name: 'Alice' })
assert((let Person = { name: String, age: Int } in { name: 'Bob', age: '30' } |> Person) == { name: 'Bob', age: 30 })
assert((let Person = { name: String, age: Int } in { name: 'Eve', age: 'bad' } |> Person) == null)
assert((let Person = { name: String } in 'not-an-object' |> Person) == null)
assert((let Person = { name: String } in null |> Person) == null)
assert((let Empty = {} in {} |> Empty) == {})
assert((let PosInt = Int(i | i > 0) in '42' |> PosInt) == 42)
assert((let PosInt = Int(i | i > 0) in '-5' |> PosInt) == null)
assert((let PosInt = Int(i | i > 0) in 'bad' |> PosInt) == null)
assert((let Ints = [Int] in ['1', '2', '3'] |> Ints) == [1, 2, 3])
assert((let Ints = [Int] in ['1', 'bad', '3'] |> Ints) == null)
assert((let Ints = [Int] in 'not-array' |> Ints) == null)
assert((let Strings = [String] in ['a', 'b'] |> Strings) == ['a', 'b'])
assert((let People = [{ name: String }] in [{ name: 'Alice' }, { name: 'Bob' }] |> People) == [{ name: 'Alice' }, { name: 'Bob' }])
assert((let T = Int|String in '42' |> T) == 42)
assert((let T = Int|String in 'hello' |> T) == 'hello')
assert((let T = String|Int in '42' |> T) == '42')
assert((let T = Int|String in true |> T) == null)
assert((let T = Int|String|Bool in true |> T) == true)
assert((let T = [Int|String] in ['1', 'hello', '3'] |> T) == [1, 'hello', 3])
assert((let Person = { age: Int(i | i > 10) } in { age: 11 } |> Person) == { age: 11 })
assert((let Person = { age: Int(i | i > 10) } in { age: 10 } |> Person) == null)
assert((let Person = { name: String, nickname :? String } in { name: 'Alice' } |> Person) == { name: 'Alice', nickname: null })
assert((let Person = { name: String, nickname :? String } in { name: 'Bob', nickname: 'Bobby' } |> Person) == { name: 'Bob', nickname: 'Bobby' })
assert((let Person = { name: String, age :? Int } in { name: 'Eve', age: '25' } |> Person) == { name: 'Eve', age: 25 })
assert((let Person = { name: String, age :? Int } in { name: 'Eve', age: 'bad' } |> Person) == null)
