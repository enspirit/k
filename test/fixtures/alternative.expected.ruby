(raise "Assertion failed" unless ->() { _err = nil; begin; v = 42; return v unless v.nil?; rescue => e; _err = e.message; end; begin; v = 0; return v unless v.nil?; rescue => e; _err = e.message; end; nil }.call == 42; true)
(raise "Assertion failed" unless ->() { _err = nil; begin; v = "hello"; return v unless v.nil?; rescue => e; _err = e.message; end; begin; v = "default"; return v unless v.nil?; rescue => e; _err = e.message; end; nil }.call == "hello"; true)
(raise "Assertion failed" unless ->() { _err = nil; begin; v = "hello".index("l"); return v unless v.nil?; rescue => e; _err = e.message; end; begin; v = -1; return v unless v.nil?; rescue => e; _err = e.message; end; nil }.call == 2; true)
(raise "Assertion failed" unless ->() { _err = nil; begin; v = "hello".index("x"); return v unless v.nil?; rescue => e; _err = e.message; end; begin; v = -1; return v unless v.nil?; rescue => e; _err = e.message; end; nil }.call == -1; true)
(raise "Assertion failed" unless ->() { _err = nil; begin; v = "hello".index("x"); return v unless v.nil?; rescue => e; _err = e.message; end; begin; v = "hello".index("z"); return v unless v.nil?; rescue => e; _err = e.message; end; begin; v = -1; return v unless v.nil?; rescue => e; _err = e.message; end; nil }.call == -1; true)
(raise "Assertion failed" unless ->() { _err = nil; begin; v = "hello".index("x"); return v unless v.nil?; rescue => e; _err = e.message; end; begin; v = "hello".index("l"); return v unless v.nil?; rescue => e; _err = e.message; end; begin; v = -1; return v unless v.nil?; rescue => e; _err = e.message; end; nil }.call == 2; true)
(raise "Assertion failed" unless ->(x) { ->() { _err = nil; begin; v = x; return v unless v.nil?; rescue => e; _err = e.message; end; begin; v = 0; return v unless v.nil?; rescue => e; _err = e.message; end; nil }.call }.call(42) == 42; true)
